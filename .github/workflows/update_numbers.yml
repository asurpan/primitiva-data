# update_script.py
import requests
from bs4 import BeautifulSoup
import json

# URL de la página de la Bruja con los números más frecuentes
URL = "https://www.labrujadeoro.es/primitiva"

print(f"Descargando datos desde: {URL}")
response = requests.get(URL)
response.raise_for_status()  # Lanza error si la página no responde correctamente

html = response.text

# Parsear HTML con BeautifulSoup
soup = BeautifulSoup(html, 'html.parser')

# Buscar los números frecuentes (la estructura puede cambiar, aquí según la página actual)
# Normalmente están dentro de un div con clase 'estadisticas' o similar
# Vamos a buscar los primeros 10 números más frecuentes como ejemplo
numbers = []

# Este selector depende de la estructura real de la página
# Aquí buscamos todos los elementos que contengan los números frecuentes
for li in soup.select("ul.frequent_numbers li"):
    try:
        num = int(li.get_text(strip=True))
        numbers.append(num)
    except ValueError:
        continue

# Guardar en JSON
data = {"frequent_numbers": numbers}

with open("frequent_numbers.json", "w", encoding="utf-8") as f:
    json.dump(data, f, ensure_ascii=False, indent=2)

print("Números frecuentes actualizados:", numbers)
print("Archivo frequent_numbers.json guardado correctamente.")
